(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{484:function(s,e,a){"use strict";a.r(e);var t=a(2),r=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("做性能分析是为了sql调优")]),s._v(" "),e("h3",{attrs:{id:"_1-查看执行频率"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看执行频率"}},[s._v("#")]),s._v(" 1.查看执行频率")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("global")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("status")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Com_______'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 七个下划线")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("就可以查询各个操作的执行频率")]),s._v(" "),e("p",[s._v("查看分析当前数据库是以什么操作为主")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://18334034784.oss-cn-chengdu.aliyuncs.com/lin-oss/%E6%9F%A5%E7%9C%8B%E6%89%A7%E8%A1%8C%E9%A2%91%E7%8E%87.png",alt:"image-20231018145831436"}})]),s._v(" "),e("h3",{attrs:{id:"_2-慢查询日志"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-慢查询日志"}},[s._v("#")]),s._v(" 2. 慢查询日志")]),s._v(" "),e("p",[s._v("根据查询结果得知,大部分数据库select操作占主导")]),s._v(" "),e("p",[s._v("慢查询日志记录了所有执行时间超过指定参数(long_query_time，单位:秒，默认10秒)的所有SQL语句的日志")]),s._v(" "),e("p",[s._v("MySQL的慢查询日志默认没有开启,需要在MYSQL的配置文件中进行配置")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启MySQL慢日志查询开关")]),s._v("\nslow_query_log "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置慢日志的时间为n秒,SQL语句执行之间超过n秒就会被视为慢查询,记录慢查询日志")]),s._v("\nlong_query_time"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("慢查询日志中存放主机用户,执行时间,锁时间,执行的语句等等")]),s._v(" "),e("h3",{attrs:{id:"_3-profile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-profile"}},[s._v("#")]),s._v(" 3.profile")]),s._v(" "),e("p",[s._v("获得了慢查询日志,但是只会记录超过给定时间的日志")]),s._v(" "),e("p",[s._v("有一些sql语句执行之间未超过给定时间却趋近给定时间")]),s._v(" "),e("p",[s._v("使用"),e("strong",[s._v("profile详情")])]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" profiles\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("能够在做sql优化是帮助我们了解事件都耗费到哪去了")]),s._v(" "),e("p",[s._v("查看当前mysql是否支持profile操作(默认关闭):")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[s._v("SQLECT @"),e("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@have_profiling")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("根据profile详情中的query_ID查询各个阶段的耗时")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("show")]),s._v(" profile "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" query n\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"_4-explain执行计划"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-explain执行计划"}},[s._v("#")]),s._v(" 4.explain执行计划")]),s._v(" "),e("p",[s._v("查看sql语句的执行计划")]),s._v(" "),e("p",[s._v("如如何执行,表的连接,连接顺序,是否使用索引")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPLAIN")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" 字段 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" 表 "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" 条件\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:"https://18334034784.oss-cn-chengdu.aliyuncs.com/lin-oss/SQL%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92.png",alt:"image-20231018153334480"}})]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("id")])])]),s._v(" "),e("p",[s._v("select查询的序列号,表示查询中执行select自居或者是操作表的顺序")]),s._v(" "),e("p",[s._v("id相同则从上到下")]),s._v(" "),e("p",[s._v("id不同则大的限制性")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("select_type")])])]),s._v(" "),e("p",[s._v("表示SELECT的类型,常见的取值有SIMPLE(简单表),PRIMARY(主查询),UNION(UNION中的后面的查询语句)等")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("type")])])]),s._v(" "),e("p",[s._v("表示连接类型")]),s._v(" "),e("p",[s._v("性能由好到坏的连接类型为")]),s._v(" "),e("p",[s._v("NULL, system, const, eq_ref, ref, range, index, all")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("possible_key")])])]),s._v(" "),e("p",[s._v("显示可能引用在这张表上的索引")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Key")])])]),s._v(" "),e("p",[s._v("实际使用的索引,如果为NULL则没有使用索引")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("Key_len")])])]),s._v(" "),e("p",[s._v("表示索引使用的字节数,为最大可能长度")]),s._v(" "),e("p",[s._v("在不损失精确性的前提下,长度越短越好")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("rows")])])]),s._v(" "),e("p",[s._v("MySQL认为必须要执行查询的行数")]),s._v(" "),e("ul",[e("li",[e("strong",[s._v("filtered")])])]),s._v(" "),e("p",[s._v("表示返回结果的行数占需读取行数的百分比,filtere的值越大越好")])])}),[],!1,null,null,null);e.default=r.exports}}]);